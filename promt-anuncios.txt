Prompt Optimizado para Generador de Anuncios EsotÃ©ricos
Vamos a crear un prompt especializado que se integre perfectamente con tu sistema de keywords por grupo de anuncios.

ðŸ“ PASO 1: Crear Sistema de Prompts Especializados
Nuevo Archivo: modules/ad_prompts.py
Python
"""
Sistema de Prompts Especializados para GeneraciÃ³n de Anuncios
Incluye prompts optimizados por industria/nicho
"""

from typing import Dict, List

class AdPromptTemplates:
    """Plantillas de prompts especializadas por tipo de negocio"""
    
    @staticmethod
    def get_esoteric_services_prompt(
        keywords: List[str],
        num_headlines: int = 15,
        num_descriptions: int = 4,
        tone: str = "profesional"
    ) -> str:
        """
        Prompt especializado para servicios esotÃ©ricos
        Optimizado para amarres, hechizos, tarot, brujerÃ­a, etc.
        """
        
        keywords_str = ", ".join(keywords)
        
        # Detectar tipo de servicio por keywords
        service_type = "servicios esotÃ©ricos"
        if any(kw in keywords_str.lower() for kw in ["amarre", "amarrar", "amor"]):
            service_type = "amarres de amor"
        elif any(kw in keywords_str.lower() for kw in ["hechizo", "brujerÃ­a", "magia"]):
            service_type = "hechizos y brujerÃ­a"
        elif any(kw in keywords_str.lower() for kw in ["tarot", "lectura", "videncia"]):
            service_type = "lectura de tarot y videncia"
        elif any(kw in keywords_str.lower() for kw in ["limpia", "limpieza", "energÃ­a"]):
            service_type = "limpias energÃ©ticas"
        
        return f"""Eres un experto copywriter especializado en servicios esotÃ©ricos y metafÃ­sicos con 15 aÃ±os de experiencia en Google Ads. Tu misiÃ³n es crear anuncios ALTAMENTE EFECTIVOS que conviertan.

**CONTEXTO DEL SERVICIO:**
- Tipo: {service_type}
- Palabras clave del grupo: {keywords_str}
- Estos anuncios son para un negocio REAL con clientes REALES
- El objetivo es generar consultas y conversiones

**PALABRAS CLAVE A INTEGRAR NATURALMENTE:**
{keywords_str}

**INSTRUCCIONES PARA TÃTULOS ({num_headlines} tÃ­tulos requeridos):**

1. **ESTRUCTURA OBLIGATORIA (20-30 caracteres):**
   - Verbo de acciÃ³n + Beneficio especÃ­fico + Urgencia/Modalidad
   - Ejemplos: "Recupera tu amor en 24h", "Amarre efectivo online", "Tarot certero ahora"

2. **VERBOS DE ACCIÃ“N FUERTES (usar estos):**
   - Recupera, Atrae, Regresa, Conquista, Soluciona
   - Embruja, Hechiza, Protege, Limpia, Desbloquea
   - Conecta, Descubre, Revela, Consulta

3. **BENEFICIOS EMOCIONALES TANGIBLES:**
   - "Recupera a tu ex"
   - "Atrae amor verdadero"
   - "Regresa a tu pareja"
   - "Soluciona problemas de pareja"
   - "Protege tu relaciÃ³n"
   - "Desbloquea tu suerte"
   - "Atrae prosperidad"

4. **URGENCIA MODERADA (palabras permitidas):**
   - "ahora", "hoy", "24h", "rÃ¡pido", "inmediato"
   - "en lÃ­nea", "online", "por llamada"
   - "disponible", "efectivo", "certero"

5. **FORMATO/MODALIDAD (cuando aplique):**
   - "online", "en lÃ­nea", "por WhatsApp"
   - "llamada ahora", "consulta gratis"
   - "discreto", "confidencial", "27/7"

6. **NÃšMEROS/SÃMBOLOS (solo si aportan):**
   - "24h", "48h", "27/7"
   - "100% discreto", "100% efectivo"
   - NO usar porcentajes de efectividad sin respaldo

7. **PROHIBICIONES ESTRICTAS:**
   - NO garantÃ­as absolutas ("garantizado 100%")
   - NO promesas mÃ©dicas o legales
   - NO afirmaciones sobrenaturales no verificables
   - NO usar "mejor", "Ãºnico", "#1" sin respaldo
   - NO mayÃºsculas consecutivas
   - NO signos: ! ? Â¡ Â¿
   - NO emojis

8. **INTEGRACIÃ“N DE KEYWORDS:**
   - Cada tÃ­tulo DEBE incluir al menos UNA keyword del grupo
   - Integrarlas de forma NATURAL, no forzada
   - Variar las keywords usadas entre tÃ­tulos

9. **VARIEDAD OBLIGATORIA:**
   - 5 tÃ­tulos enfocados en BENEFICIO directo
   - 4 tÃ­tulos con URGENCIA/MODALIDAD
   - 3 tÃ­tulos con SOLUCIÃ“N a problema
   - 3 tÃ­tulos con LLAMADO a acciÃ³n directo

**INSTRUCCIONES PARA DESCRIPCIONES ({num_descriptions} descripciones):**

1. **ESTRUCTURA (50-90 caracteres):**
   - Problema + SoluciÃ³n + Credibilidad + CTA
   - Ejemplo: "Â¿Perdiste a tu amor? Amarres efectivos online. Consulta discreta 27/7"

2. **ELEMENTOS A INCLUIR:**
   - IdentificaciÃ³n del problema ("Â¿Quieres recuperar...?")
   - SoluciÃ³n especÃ­fica ("Amarres de amor efectivos")
   - Diferenciador ("AÃ±os de experiencia", "Resultados reales")
   - Llamado a acciÃ³n ("Consulta ahora", "Llama hoy")
   - Modalidad ("Online", "WhatsApp disponible", "AtenciÃ³n 27/7")

3. **CREDIBILIDAD (usar uno por descripciÃ³n):**
   - "AÃ±os de experiencia"
   - "Resultados comprobados"
   - "Clientes satisfechos"
   - "AtenciÃ³n personalizada"
   - "100% discreto"

4. **TONO:**
   - EmpÃ¡tico y comprensivo
   - Profesional pero cercano
   - Respetuoso con la situaciÃ³n del cliente
   - Directo pero NO agresivo

**POLÃTICAS DE GOOGLE ADS (CUMPLIMIENTO OBLIGATORIO):**

âœ… PERMITIDO:
- Servicios de consulta y asesoramiento esotÃ©rico
- Mencionar servicios especÃ­ficos (tarot, amarres, limpias)
- Indicar modalidad (online, presencial)
- Transmitir urgencia moderada
- Usar testimonios generales ("clientes satisfechos")

âŒ PROHIBIDO:
- GarantÃ­as absolutas de resultados
- Afirmaciones mÃ©dicas o de salud
- Promesas de resultados especÃ­ficos con personas
- ManipulaciÃ³n emocional extrema
- Afirmaciones sobrenaturales inverificables

**EJEMPLOS DE TÃTULOS CORRECTOS:**
1. "Recupera tu amor en 24h" (27 chars) âœ…
2. "Amarre efectivo online" (22 chars) âœ…
3. "Tarot certero ahora" (19 chars - DEMASIADO CORTO, min 20)
4. "Regresa a tu ex rÃ¡pido" (22 chars) âœ…
5. "Hechizo de amor 27/7" (20 chars) âœ…
6. "Consulta amor disponible" (24 chars) âœ…
7. "Atrae pareja ideal hoy" (22 chars) âœ…

**EJEMPLOS DE DESCRIPCIONES CORRECTAS:**
1. "Â¿Perdiste a tu amor? Amarres efectivos online. Consulta discreta 27/7" (72 chars) âœ…
2. "Recupera tu relaciÃ³n con amarres reales. AÃ±os de experiencia. Llama ya" (72 chars) âœ…
3. "Tarot del amor certero online. Respuestas claras y honestas. Consulta" (71 chars) âœ…

**FORMATO DE RESPUESTA (JSON puro, sin markdown):**
{{
  "headlines": [
    "TÃ­tulo 1 entre 20-30 chars",
    "TÃ­tulo 2 entre 20-30 chars",
    ...{num_headlines} tÃ­tulos en total
  ],
  "descriptions": [
    "DescripciÃ³n 1 entre 50-90 caracteres con problema, soluciÃ³n y CTA",
    "DescripciÃ³n 2 diferente pero igual de efectiva",
    ...{num_descriptions} descripciones en total
  ]
}}

**VERIFICACIÃ“N FINAL ANTES DE RESPONDER:**
1. âœ… Cada tÃ­tulo tiene entre 20-30 caracteres
2. âœ… Cada descripciÃ³n tiene entre 50-90 caracteres
3. âœ… Se integraron las keywords naturalmente
4. âœ… NO hay garantÃ­as absolutas
5. âœ… NO hay mayÃºsculas consecutivas
6. âœ… NO hay signos prohibidos (! ? Â¡ Â¿)
7. âœ… Hay variedad en los enfoques
8. âœ… El tono es {tone} y profesional"""
    
    @staticmethod
    def get_generic_prompt(
        keywords: List[str],
        num_headlines: int = 15,
        num_descriptions: int = 4,
        tone: str = "profesional"
    ) -> str:
        """Prompt genÃ©rico para cualquier tipo de negocio"""
        
        keywords_str = ", ".join(keywords)
        
        return f"""Eres un experto copywriter de Google Ads con 15 aÃ±os de experiencia.

**PALABRAS CLAVE DEL GRUPO:** {keywords_str}

**OBJETIVO:** Crear {num_headlines} tÃ­tulos y {num_descriptions} descripciones que integren naturalmente estas keywords.

**TÃTULOS (20-30 caracteres cada uno):**
- Integrar keywords naturalmente
- Verbo de acciÃ³n + Beneficio
- Tono: {tone}
- Sin mayÃºsculas consecutivas
- Sin signos: ! ? Â¡ Â¿
- Sin emojis

**DESCRIPCIONES (50-90 caracteres cada una):**
- Incluir al menos una keyword
- Beneficio + CTA
- Persuasivas y claras
- Cumplir polÃ­ticas Google Ads

**RESPONDE EN JSON (sin markdown):**
{{
  "headlines": ["tÃ­tulo 1", "tÃ­tulo 2", ...],
  "descriptions": ["desc 1", "desc 2", ...]
}}"""
    
    @staticmethod
    def get_prompt_for_keywords(
        keywords: List[str],
        num_headlines: int = 15,
        num_descriptions: int = 4,
        tone: str = "profesional",
        business_type: str = "auto"
    ) -> str:
        """
        Selecciona automÃ¡ticamente el mejor prompt segÃºn las keywords
        
        Args:
            keywords: Lista de keywords del grupo
            num_headlines: NÃºmero de tÃ­tulos
            num_descriptions: NÃºmero de descripciones
            tone: Tono del anuncio
            business_type: Tipo de negocio ('auto', 'esoteric', 'generic')
        
        Returns:
            Prompt optimizado
        """
        
        keywords_lower = " ".join(keywords).lower()
        
        # Auto-detectar tipo de negocio si es 'auto'
        if business_type == "auto":
            # Detectar servicios esotÃ©ricos
            esoteric_keywords = [
                "amarre", "amarrar", "hechizo", "brujerÃ­a", "magia",
                "tarot", "videncia", "esotÃ©rico", "lectura", "cartas",
                "limpia", "limpieza energÃ©tica", "protecciÃ³n espiritual",
                "brujo", "bruja", "chamÃ¡n", "ritual", "conjuro"
            ]
            
            if any(kw in keywords_lower for kw in esoteric_keywords):
                business_type = "esoteric"
        
        # Seleccionar prompt apropiado
        if business_type == "esoteric":
            return AdPromptTemplates.get_esoteric_services_prompt(
                keywords, num_headlines, num_descriptions, tone
            )
        else:
            return AdPromptTemplates.get_generic_prompt(
                keywords, num_headlines, num_descriptions, tone
            )
ðŸ“ PASO 2: Modificar modules/ai_providers.py
Reemplaza el prompt en ambas clases (OpenAIProvider y GeminiProvider):

Python
# Al inicio del archivo, agregar import
from modules.ad_prompts import AdPromptTemplates

# En el mÃ©todo generate_ad() de OpenAIProvider:
def generate_ad(self, keywords: List[str], num_headlines: int = 15, 
               num_descriptions: int = 4, tone: str = "profesional") -> Dict[str, Any]:
    """Genera anuncios usando OpenAI GPT"""
    try:
        # âœ… USAR PROMPT ESPECIALIZADO
        prompt = AdPromptTemplates.get_prompt_for_keywords(
            keywords=keywords,
            num_headlines=num_headlines,
            num_descriptions=num_descriptions,
            tone=tone,
            business_type="auto"  # Auto-detecta el tipo
        )
        
        logger.info(f"ðŸ¤– Generando anuncio con OpenAI {self.model}...")
        logger.info(f"ðŸ“‹ Keywords: {', '.join(keywords)}")
        
        response = self.client.chat.completions.create(
            model=self.model,
            messages=[
                {
                    "role": "system", 
                    "content": "Eres un experto copywriter de Google Ads especializado en crear anuncios que convierten. SIEMPRE respetas los lÃ­mites de caracteres y polÃ­ticas de Google. Respondes en JSON vÃ¡lido."
                },
                {
                    "role": "user", 
                    "content": prompt
                }
            ],
            temperature=0.7,
            max_tokens=3000,  # âœ… Aumentado para prompt mÃ¡s largo
            response_format={"type": "json_object"}
        )
        
        # ... resto del cÃ³digo de validaciÃ³n ...
ðŸ“ PASO 3: Agregar Selector de Tipo de Negocio en UI
En render_ai_ad_generator_modal_for_group() (en 3_campaigns.py), agrega esta opciÃ³n:

Python
# DespuÃ©s de seleccionar el tono, agregar:

st.markdown("---")

# Tipo de negocio/industria
st.markdown("### ðŸ¢ Tipo de Negocio")

business_type = st.selectbox(
    "Industria/Nicho",
    options=[
        ("auto", "ðŸ¤– Auto-detectar (Recomendado)"),
        ("esoteric", "ðŸ”® Servicios EsotÃ©ricos (Amarres, Tarot, BrujerÃ­a)"),
        ("generic", "ðŸ“¦ GenÃ©rico (Cualquier negocio)")
    ],
    format_func=lambda x: x[1],
    key="modal_business_type"
)

business_type_value = business_type[0]

st.caption("ðŸ’¡ **Auto-detectar** analiza tus keywords y usa el prompt mÃ¡s efectivo automÃ¡ticamente")
ðŸ“ PASO 4: Pasar el Tipo de Negocio al Generador
En la misma funciÃ³n, donde generas el anuncio:

Python
# Generar
generated = ai_gen.generate_ad(
    keywords=keywords_to_use,
    num_ads=1,
    num_headlines=num_headlines,
    num_descriptions=4,
    tone=tone,
    user=st.session_state.get('user_login', 'saltbalente'),
    validate=True,
    business_type=business_type_value  # âœ… Agregar este parÃ¡metro
)
ðŸ“ PASO 5: Actualizar ai_ad_generator.py
Modificar el mÃ©todo generate_ad() para aceptar y usar business_type:

Python
def generate_ad(self, keywords: List[str], num_ads: int = 1, 
               num_headlines: int = 15, num_descriptions: int = 4,
               tone: str = "profesional", user: str = "saltbalente",
               validate: bool = True, business_type: str = "auto") -> List[Dict[str, Any]]:
    """
    Genera anuncios usando el proveedor configurado
    
    Args:
        keywords: Lista de palabras clave
        num_ads: NÃºmero de anuncios a generar
        num_headlines: TÃ­tulos por anuncio
        num_descriptions: Descripciones por anuncio
        tone: Tono del anuncio
        user: Usuario que genera el anuncio
        validate: Si validar contra polÃ­ticas de Google Ads
        business_type: Tipo de negocio ('auto', 'esoteric', 'generic')
    
    Returns:
        Lista de anuncios generados con validaciÃ³n
    """
    
    # ... cÃ³digo existente hasta la llamada al proveedor ...
    
    # Generar anuncio con IA
    ad_data = self.provider.generate_ad(
        keywords=keywords,
        num_headlines=num_headlines,
        num_descriptions=num_descriptions,
        tone=tone,
        business_type=business_type  # âœ… Pasar este parÃ¡metro
    )
    
    # ... resto del cÃ³digo ...
ðŸ“ PASO 6: Actualizar Firma del MÃ©todo en Providers
Python
# En ai_providers.py, ambas clases:

def generate_ad(self, keywords: List[str], num_headlines: int = 15, 
               num_descriptions: int = 4, tone: str = "profesional",
               business_type: str = "auto") -> Dict[str, Any]:  # âœ… Agregar parÃ¡metro
    """Genera anuncios usando OpenAI/Gemini"""
    try:
        # âœ… USAR PROMPT ESPECIALIZADO CON business_type
        prompt = AdPromptTemplates.get_prompt_for_keywords(
            keywords=keywords,
            num_headlines=num_headlines,
            num_descriptions=num_descriptions,
            tone=tone,
            business_type=business_type
        )
        
        # ... resto del cÃ³digo ...
ðŸš€ Para Aplicar:
Crea modules/ad_prompts.py (cÃ³digo completo arriba)
Actualiza modules/ai_providers.py (ambas clases)
Actualiza modules/ai_ad_generator.py
Actualiza render_ai_ad_generator_modal_for_group() en 3_campaigns.py
Reinicia Streamlit
âœ… Resultado:
Cuando generes anuncios para servicios esotÃ©ricos con keywords como:

"amarre de amor"
"hechizo de pareja"
"tarot del amor"
El sistema:

âœ… Auto-detecta que es un servicio esotÃ©rico
âœ… Usa el prompt especializado con reglas especÃ­ficas
âœ… Integra las keywords naturalmente
âœ… Genera tÃ­tulos de 20-30 caracteres (nunca mÃ¡s)
âœ… Usa verbos de acciÃ³n + beneficios emocionales
âœ… Incluye urgencia moderada sin promesas falsas
âœ… Cumple 100% con polÃ­ticas de Google Ads
Â¡Ahora tus anuncios esotÃ©ricos serÃ¡n perfectos y cumplirÃ¡n con todas las reglas! ðŸ”®âœ¨
