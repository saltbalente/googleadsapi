Copilot said: # ğŸ”§ **SoluciÃ³n: Campo de Palabras Clave
ğŸ”§ SoluciÃ³n: Campo de Palabras Clave No Funcional
El problema estÃ¡ en la funciÃ³n render_keywords_editor(). Probablemente los inputs de keywords no estÃ¡n actualizando correctamente el estado del grupo.

ğŸ“ SOLUCIÃ“N: Corregir render_keywords_editor() en 3_campaigns.py
Busca la funciÃ³n completa y reemplÃ¡zala con esta versiÃ³n corregida:

Python
def render_keywords_editor():
    """Renderiza el editor de palabras clave"""
    if not st.session_state.current_ad_group:
        st.error("âŒ No hay grupo de anuncios activo")
        return
    
    st.markdown("### ğŸ”‘ Editor de Palabras Clave")
    
    st.markdown("""
    <div class="insight-card-info">
        <strong>ğŸ’¡ Consejos para Palabras Clave:</strong><br>
        â€¢ <strong>Concordancia amplia:</strong> Mayor alcance, menos control<br>
        â€¢ <strong>Concordancia de frase:</strong> Balance entre alcance y control<br>
        â€¢ <strong>Concordancia exacta:</strong> MÃ¡ximo control, menor alcance
    </div>
    """, unsafe_allow_html=True)
    
    st.markdown("---")
    
    # ========== AGREGAR PALABRA CLAVE INDIVIDUAL ==========
    st.markdown("#### â• Agregar Palabra Clave Individual")
    
    col_kw1, col_kw2, col_kw3 = st.columns([3, 2, 1])
    
    with col_kw1:
        new_keyword = st.text_input(
            "Nueva Palabra Clave",
            placeholder="Ej: zapatos deportivos",
            key="new_keyword_input",
            help="Ingresa una palabra clave y presiona Enter o click en Agregar"
        )
    
    with col_kw2:
        match_type = st.selectbox(
            "Tipo de Concordancia",
            options=["BROAD", "PHRASE", "EXACT"],
            format_func=lambda x: {
                "BROAD": "ğŸŒ Amplia",
                "PHRASE": "ğŸ“ Frase",
                "EXACT": "ğŸ¯ Exacta"
            }[x],
            key="new_keyword_match_type"
        )
    
    with col_kw3:
        st.markdown("<br>", unsafe_allow_html=True)  # Espaciado
        if st.button("â• Agregar", use_container_width=True, type="primary", key="add_single_keyword_btn"):
            if new_keyword and new_keyword.strip():
                # âœ… Agregar directamente al objeto en session_state
                st.session_state.current_ad_group.keywords.append({
                    'text': new_keyword.strip(),
                    'match_type': match_type
                })
                st.success(f"âœ… Palabra clave agregada: {new_keyword}")
                logger.info(f"Keyword agregada: {new_keyword} ({match_type})")
                time.sleep(0.5)
                st.rerun()
            else:
                st.warning("âš ï¸ Ingresa una palabra clave vÃ¡lida")
    
    st.markdown("---")
    
    # ========== AGREGAR MÃšLTIPLES KEYWORDS ==========
    st.markdown("#### ğŸ“‹ Agregar MÃºltiples Palabras Clave")
    st.caption("Ingresa una palabra clave por lÃ­nea")
    
    col_bulk1, col_bulk2 = st.columns([3, 1])
    
    with col_bulk1:
        bulk_keywords = st.text_area(
            "Palabras Clave (una por lÃ­nea)",
            height=150,
            placeholder="zapatos deportivos\nzapatillas running\ntenis para correr",
            key="bulk_keywords",
            help="Escribe cada palabra clave en una lÃ­nea nueva"
        )
    
    with col_bulk2:
        bulk_match_type = st.selectbox(
            "Tipo para todas",
            options=["BROAD", "PHRASE", "EXACT"],
            format_func=lambda x: {
                "BROAD": "ğŸŒ Amplia",
                "PHRASE": "ğŸ“ Frase",
                "EXACT": "ğŸ¯ Exacta"
            }[x],
            key="bulk_match_type"
        )
        
        st.markdown("<br>", unsafe_allow_html=True)
        
        if st.button("â• Agregar Todas", use_container_width=True, key="add_bulk_keywords_btn"):
            if bulk_keywords and bulk_keywords.strip():
                keywords_list = [kw.strip() for kw in bulk_keywords.strip().split('\n') if kw.strip()]
                
                if keywords_list:
                    # âœ… Agregar todas directamente
                    for kw in keywords_list:
                        st.session_state.current_ad_group.keywords.append({
                            'text': kw,
                            'match_type': bulk_match_type
                        })
                    
                    st.success(f"âœ… {len(keywords_list)} palabras clave agregadas")
                    logger.info(f"{len(keywords_list)} keywords agregadas en bulk")
                    time.sleep(0.5)
                    st.rerun()
                else:
                    st.warning("âš ï¸ No se encontraron palabras clave vÃ¡lidas")
            else:
                st.warning("âš ï¸ Escribe al menos una palabra clave")
    
    st.markdown("---")
    
    # ========== LISTA DE KEYWORDS ACTUALES ==========
    st.markdown("#### ğŸ“ Palabras Clave del Grupo")
    
    current_keywords = st.session_state.current_ad_group.keywords
    
    if current_keywords and len(current_keywords) > 0:
        st.success(f"âœ… Total: {len(current_keywords)} palabras clave")
        
        # Mostrar cada keyword con opciÃ³n de eliminar
        for idx, kw in enumerate(current_keywords):
            col_kw_text, col_kw_type, col_kw_actions = st.columns([3, 2, 1])
            
            with col_kw_text:
                match_icon = {
                    "BROAD": "ğŸŒ",
                    "PHRASE": "ğŸ“",
                    "EXACT": "ğŸ¯"
                }.get(kw['match_type'], "ğŸ”‘")
                st.text(f"{match_icon} {kw['text']}")
            
            with col_kw_type:
                st.caption(f"Concordancia: {kw['match_type']}")
            
            with col_kw_actions:
                # âœ… Key Ãºnico usando Ã­ndice + hash del texto
                unique_key = f"delete_kw_{idx}_{hash(kw['text']) % 10000}"
                if st.button("ğŸ—‘ï¸", key=unique_key, help="Eliminar palabra clave"):
                    # âœ… Eliminar directamente
                    st.session_state.current_ad_group.keywords.pop(idx)
                    st.success("âœ… Palabra clave eliminada")
                    logger.info(f"Keyword eliminada: {kw['text']}")
                    time.sleep(0.3)
                    st.rerun()
        
        st.markdown("---")
        
        # Opciones de exportaciÃ³n
        col_export, col_clear = st.columns(2)
        
        with col_export:
            # Crear CSV de keywords
            keywords_csv = "Palabra Clave,Tipo de Concordancia\n"
            for kw in current_keywords:
                keywords_csv += f"{kw['text']},{kw['match_type']}\n"
            
            st.download_button(
                "ğŸ“¥ Exportar Keywords (CSV)",
                keywords_csv,
                f"keywords_{datetime.now().strftime('%Y%m%d_%H%M%S')}.csv",
                "text/csv",
                use_container_width=True
            )
        
        with col_clear:
            if st.button("ğŸ—‘ï¸ Limpiar Todas", use_container_width=True, key="clear_all_keywords_btn"):
                # ConfirmaciÃ³n
                if 'confirm_clear_keywords' not in st.session_state:
                    st.session_state.confirm_clear_keywords = False
                
                if not st.session_state.confirm_clear_keywords:
                    st.session_state.confirm_clear_keywords = True
                    st.warning("âš ï¸ Haz clic de nuevo para confirmar")
                    time.sleep(1)
                    st.rerun()
                else:
                    st.session_state.current_ad_group.keywords = []
                    st.session_state.confirm_clear_keywords = False
                    st.success("âœ… Todas las palabras clave eliminadas")
                    logger.info("Todas las keywords eliminadas")
                    time.sleep(0.5)
                    st.rerun()
    
    else:
        st.info("ğŸ’¡ Agrega al menos una palabra clave para este grupo de anuncios")
        st.caption("Las palabras clave determinan cuÃ¡ndo se mostrarÃ¡n tus anuncios")
ğŸ“ VERIFICAR: Estado del Grupo se Mantiene
AsegÃºrate que en render_ad_group_editor_modal() el grupo se estÃ© guardando correctamente:

Python
def render_ad_group_editor_modal():
    """Modal principal para crear/editar un grupo de anuncios"""
    
    st.markdown("## ğŸ§© Editor de Grupo de Anuncios")
    
    # âœ… VERIFICAR QUE EXISTE EL GRUPO ACTUAL
    if not st.session_state.current_ad_group:
        st.session_state.current_ad_group = AdGroup()
        logger.info("âœ… Grupo de anuncios creado en session state")
    
    current_group = st.session_state.current_ad_group
    
    # âœ… LOG DE DEBUG (temporal)
    logger.info(f"ğŸ” Grupo actual - Keywords: {len(current_group.keywords)}")
    
    # Tabs para organizar el contenido
    tab_general, tab_ads, tab_keywords = st.tabs([
        "âš™ï¸ General",
        f"ğŸª§ Anuncios ({len(current_group.ads)}/3)",
        f"ğŸ”‘ Palabras Clave ({len(current_group.keywords)})"  # âœ… Mostrar contador en tiempo real
    ])
    
    # ... resto de tabs ...
    
    with tab_keywords:
        render_keywords_editor()
    
    # âœ… VERIFICAR ANTES DE GUARDAR
    st.markdown("---")
    st.markdown("### ğŸ’¾ Guardar Grupo")
    
    # Mostrar validaciÃ³n visual
    col_val1, col_val2, col_val3 = st.columns(3)
    
    with col_val1:
        name_valid = bool(current_group.name.strip())
        st.metric("ğŸ“ Nombre", "âœ…" if name_valid else "âŒ")
    
    with col_val2:
        ads_valid = len(current_group.ads) > 0 and all(ad.is_valid() for ad in current_group.ads)
        st.metric("ğŸª§ Anuncios", f"{len(current_group.ads)}/1 mÃ­n")
    
    with col_val3:
        kw_valid = len(current_group.keywords) > 0
        st.metric("ğŸ”‘ Keywords", f"{len(current_group.keywords)}/1 mÃ­n")
    
    # âœ… MOSTRAR ERRORES ESPECÃFICOS
    if not current_group.is_valid():
        st.warning("âš ï¸ Completa los siguientes campos:")
        issues = []
        
        if not current_group.name.strip():
            issues.append("âŒ Falta nombre del grupo")
        
        if len(current_group.ads) == 0:
            issues.append("âŒ Falta al menos 1 anuncio")
        elif not all(ad.is_valid() for ad in current_group.ads):
            issues.append("âŒ Hay anuncios incompletos (falta URL o contenido mÃ­nimo)")
        
        if len(current_group.keywords) == 0:
            issues.append("âŒ Falta al menos 1 palabra clave")
        
        for issue in issues:
            st.write(issue)
    
    st.markdown("---")
    
    # Botones de acciÃ³n
    col_action1, col_action2, col_action3 = st.columns([1, 1, 1])
    
    with col_action1:
        can_save = current_group.is_valid()
        
        if st.button(
            "âœ… Guardar Grupo de Anuncios",
            use_container_width=True,
            type="primary",
            disabled=not can_save,
            key="save_ad_group_final_btn"
        ):
            # âœ… LOG ANTES DE GUARDAR
            logger.info(f"ğŸ’¾ Guardando grupo: {current_group.name}")
            logger.info(f"   - Anuncios: {len(current_group.ads)}")
            logger.info(f"   - Keywords: {len(current_group.keywords)}")
            
            # Agregar a la lista de grupos pendientes
            st.session_state.pending_ad_groups.append(current_group.to_dict())
            
            # Limpiar estado
            st.session_state.show_create_ad_group_modal = False
            st.session_state.current_ad_group = None
            
            st.success(f"âœ… Grupo '{current_group.name}' guardado correctamente")
            logger.info("âœ… Grupo guardado en pending_ad_groups")
            
            time.sleep(1)
            st.rerun()
    
    with col_action2:
        if st.button(
            "ğŸ’¾ Guardar y Crear Otro",
            use_container_width=True,
            disabled=not can_save,
            key="save_and_create_another_group_btn"
        ):
            st.session_state.pending_ad_groups.append(current_group.to_dict())
            st.session_state.current_ad_group = AdGroup()
            
            st.success(f"âœ… Grupo '{current_group.name}' guardado. Crea otro.")
            time.sleep(1)
            st.rerun()
    
    with col_action3:
        if st.button("âŒ Cancelar", use_container_width=True, key="cancel_ad_group_creation_btn"):
            st.session_state.show_create_ad_group_modal = False
            st.session_state.current_ad_group = None
            st.rerun()
ğŸš€ Para Aplicar:
Reemplaza render_keywords_editor() completa
Verifica que render_ad_group_editor_modal() tenga los logs de debug
Reinicia Streamlit
Prueba:
Ve a crear nuevo grupo
Importa un anuncio con IA
Ve a tab "Keywords"
Agrega una keyword
Verifica que el contador suba
Intenta guardar el grupo
ğŸ” Debug en Consola:
Mientras pruebas, mira la consola de Streamlit (terminal) y deberÃ­as ver:

Code
[06:30:00] âœ… Grupo de anuncios creado en session state
[06:30:05] ğŸ” Grupo actual - Keywords: 0
[06:30:10] Keyword agregada: limpias espirituales (BROAD)
[06:30:10] ğŸ” Grupo actual - Keywords: 1
[06:30:15] ğŸ’¾ Guardando grupo: Mi Grupo de Limpias
[06:30:15]    - Anuncios: 1
[06:30:15]    - Keywords: 1
[06:30:15] âœ… Grupo guardado en pending_ad_groups
Â¡Ahora deberÃ­as poder agregar keywords sin problemas! ğŸ”‘âœ¨